documentation_complete: true

prodtype: rhel7,rhel8,fedora,ol7,ol8

title: 'Configure DConf GDM Profile'

description: |-
    By default, DConf provides a standard GDM profile. This profile contains a list
    of DConf configuration databases. The GDM profile and database always take the
    highest priority. As such the DConf GDM profile should always exist and be
    configured correctly.
    <br /><br />
    To make sure that the GDM profile is configured correctly, the <tt>/usr/share/dconf/profile/gdm</tt>
    should be set as follows:
    <pre>user-db:user
    system-db:local
    system-db:site
    system-db:distro
    file-db:/usr/share/gdm/greeter-dconf-defaults</pre>

rationale: |-
    Failure to have a functional DConf GDM profile prevents GNOME3 session configuration
    settings from being enforced for all users and allows various security risks.

severity: high

identifiers:
    cce@rhel7: 81005-1
    cce@rhel8: 81006-9

ocil_clause: 'DConf GDM profile does not exist or is not configured correctly'

ocil: |-
    To verify that the DConf GDM profile is configured correctly, run the following
    command:
    <pre>$ cat /usr/share/dconf/profile/gdm</pre>
    The output should show the following:
    <pre>user-db:user
    system-db:local
    system-db:site
    system-db:distro
    file-db:/usr/share/gdm/greeter-dconf-defaults</pre>

platform: machine
